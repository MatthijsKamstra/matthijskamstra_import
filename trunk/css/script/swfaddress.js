/** * SWFAddress 2.1: Deep linking for Flash and Ajax - http://www.asual.com/swfaddress/ * * SWFAddress is (c) 2006-2007 Rostislav Hristov and is released under the MIT License: * http://www.opensource.org/licenses/mit-license.php * */if(typeof com=="undefined"){var com={};}if(typeof com.asual=="undefined"){com.asual={};}if(typeof com.asual.util=="undefined"){com.asual.util={};}com.asual.util.Browser=new function(){var _1=-1;var _2=navigator.userAgent;var _3=false;var _4=false;var _5=false;var _6=false;var _7=false;var _8=false;var _9=false;if(/MSIE/.test(_2)){_3=true;_1=parseFloat(_2.substring(_2.indexOf("MSIE")+4));}else{if(/AppleWebKit/.test(_2)){_5=true;_1=parseFloat(_2.substring(_2.indexOf("Safari")+7));}else{if(/Opera/.test(_2)){_6=true;_1=parseFloat(navigator.appVersion);}else{if(/Camino/.test(_2)){_4=true;_1=parseFloat(_2.substring(_2.indexOf("Camino")+7));}else{if(/Firefox/.test(_2)){_7=true;_1=parseFloat(_2.substring(_2.indexOf("Firefox")+8));}else{if(/Netscape/.test(_2)){_8=true;_1=parseFloat(_2.substring(_2.indexOf("Netscape")+9));}else{if(/Mozilla/.test(_2)&&/rv:/.test(_2)){_9=true;_1=parseFloat(_2.substring(_2.indexOf("rv:")+3));}}}}}}}this.getVersion=function(){return _1;};this.isIE=function(){return _3;};this.isSafari=function(){return _5;};this.isOpera=function(){return _6;};this.isCamino=function(){return _4;};this.isFirefox=function(){return _7;};this.isNetscape=function(){return _8;};this.isMozilla=function(){return _9;};};com.asual.util.Events=new function(){var _a=[];var _b=com.asual.util.Browser;var _c="DOMContentLoaded";if(_b.isIE()||_b.isSafari()){(function(){try{if(_b.isIE()||!/loaded|complete/.test(document.readyState)){document.documentElement.doScroll("left");}}catch(e){return setTimeout(arguments.callee,0);}for(var i=0,e;e=_a[i];i++){if(e.t==_c){e.l.call(null);}}})();}this.addListener=function(_f,_10,_11){_a.push({o:_f,t:_10,l:_11});if(_10==_c&&(_b.isIE()||_b.isSafari())){return;}if(_f.addEventListener){_f.addEventListener(_10,_11,false);}else{if(_f.attachEvent){_f.attachEvent("on"+_10,_11);}}};this.removeListener=function(obj,_13,_14){for(var i=0,e;e=_a[i];i++){if(e.o==obj&&e.t==_13&&e.l==_14){_a.splice(i,1);break;}}if(_13==_c&&(_b.isIE()||_b.isSafari())){return;}if(obj.removeEventListener){obj.removeEventListener(_13,_14,false);}else{if(obj.detachEvent){obj.detachEvent("on"+_13,_14);}}};var _17=function(){for(var i=0,evt;evt=_a[i];i++){if(evt.t!=_c){com.asual.util.Events.removeListener(evt.o,evt.t,evt.l);}}};this.addListener(window,"unload",_17);};SWFAddressEvent=function(_1a){this.toString=function(){return "[object SWFAddressEvent]";};this.type=_1a;this.target=[SWFAddress][0];this.value=SWFAddress.getValue();this.path=SWFAddress.getPath();this.pathNames=SWFAddress.getPathNames();this.parameters={};var _1b=SWFAddress.getParameterNames();for(var i=0,n;n=_1b[i];i++){this.parameters[n]=SWFAddress.getParameter(n);}this.parameterNames=SWFAddress.getParameterNames();};SWFAddressEvent.INIT="init";SWFAddressEvent.CHANGE="change";SWFAddress=new function(){var _1e=com.asual.util.Browser;var _1f=_1e.getVersion();var _20=false;if(_1e.isIE()){_20=_1f>=6;}else{if(_1e.isSafari()){_20=_1f>=312;}else{if(_1e.isOpera()){_20=_1f>=9.02;}else{if(_1e.isCamino()){_20=_1f>=1;}else{if(_1e.isFirefox()){_20=_1f>=1;}else{if(_1e.isNetscape()){_20=_1f>=8;}else{if(_1e.isMozilla()){_20=_1f>=1.8;}}}}}}}var _d=top.document;var _h=top.history;var _l=top.location;var _u="undefined";var _f="function";var _26,_27,_28;var _29=_d.title;var _2a=_h.length;var _2b=false;var _2c={};var _2d=[];var _2e=[];var _2f=[];_2f["history"]=true;_2f["html"]=false;_2f["strict"]=true;_2f["tracker"]="_trackDefault";if((!_20&&_l.href.indexOf("#")!=-1)||(_1e.isSafari()&&_1e.getVersion()<412&&_l.href.indexOf("#")!=-1&&_l.search!="")){_d.open();_d.write("<html><head><meta http-equiv=\"refresh\" content=\"0;url="+_l.href.substr(0,_l.href.indexOf("#"))+"\" /></head></html>");_d.close();}var _30=function(){var _31=_l.href.indexOf("#");if(_31!=-1){return unescape(_l.href.substring(_31).replace(/^#/g,""));}return "";};var _32=_30();var _33=function(_34,_35){if(_2f["strict"]){if(_35){if(_34.substr(0,1)!="/"){_34="/"+_34;}}else{if(_34==""){_34="/";}}}return _34;};var _36=function(_37){return (_1e.isIE()&&_l.protocol=="file:")?_32.replace(/\?/,"%3F"):_37;};var _38=function(el){if(el.src&&/swfaddress\.js(\?.*)?$/.test(el.src)){return el;}for(var i=0,c;c=el.childNodes[i];i++){var s=_38(c);if(s){return s;}}};var _3d=function(){if(_1e.isIE()&&_d.title!=_29){SWFAddress.setTitle(_29);}};var _3e=function(){if(!_2b){if(_1e.isIE()){if(_32!=_30()){if(_1e.getVersion()<7){_l.reload();}else{SWFAddress.setValue(_30());}}}else{if(_1e.isSafari()&&_1e.getVersion()<523){if(_2a!=_h.length){_2a=_h.length;if(typeof _2d[_2a-1]!=_u){_32=_2d[_2a-1];}_3f();}}else{if(_32!=_30()){_32=_30();_3f();}}}_3d();}};var _40=function(_41){if(SWFAddress.hasEventListener(_41)){SWFAddress.dispatchEvent(new SWFAddressEvent(_41));}_41=_41.substr(0,1).toUpperCase()+_41.substring(1);if(typeof SWFAddress["on"+_41]==_f){SWFAddress["on"+_41]();}};var _42=function(){_40("init");};var _43=function(){_40("change");};var _44=function(){for(var i=0,id;id=_2e[i];i++){var obj=document.getElementById(id);if(obj){if(obj.parentNode&&typeof obj.parentNode.so!=_u){obj.parentNode.so.call("setSWFAddressValue",SWFAddress.getValue());}else{obj=(obj&&typeof obj.setSWFAddressValue!=_u)?obj:((obj.getElementsByTagName("object")[0]&&typeof obj.getElementsByTagName("object")[0].setSWFAddressValue!=_u)?obj.getElementsByTagName("object")[0]:((obj.getElementsByTagName("embed")[0]&&typeof obj.getElementsByTagName("embed")[0].setSWFAddressValue!=_u)?obj.getElementsByTagName("embed")[0]:null));if(obj){obj.setSWFAddressValue(SWFAddress.getValue());}}}else{if(obj=document[id]){if(typeof obj.setSWFAddressValue!=_u){obj.setSWFAddressValue(SWFAddress.getValue());}}}}};var _3f=function(){_44();_43();setTimeout(_48,10);};var _49=function(_4a){if(typeof urchinTracker==_f){urchinTracker(_4a);}if(typeof pageTracker!=_u&&typeof pageTracker._trackPageview==_f){pageTracker._trackPageview(_4a);}};eval("var _trackDefault = "+_49+";");var _48=function(){if(typeof _2f["tracker"]!=_u&&eval("typeof "+_2f["tracker"]+" != \"undefined\"")){var fn=eval(_2f["tracker"]);if(typeof fn==_f){fn((_l.pathname+SWFAddress.getValue()).replace(/\/\//,"/").replace(/^\/$/,""));}}};var _4c=function(){var doc=_26.contentWindow.document;doc.open();doc.write("<script>var swfaddress = \""+_30()+"\";</script>");doc.close();};var _4e=function(){if(_2f["html"]){var src=_26.contentWindow.location.href;_32=(src.indexOf("?")>-1)?src.substring(src.indexOf("?")+1):"";}else{_32=(typeof _26.contentWindow.swfaddress!=_u)?_26.contentWindow.swfaddress:"";}_26.contentWindow.document.title=_d.title;if(_32!=_30()){_3f();_l.hash=_36(_32);}};var _50=function(){var _51="id=\"swfaddress\" style=\"position:absolute;top:-9999px;\"";if(_1e.isIE()){document.body.appendChild(document.createElement("div")).innerHTML="<iframe "+_51+" src=\""+(_2f["html"]?_28.replace(/\.js(\?.*)?$/,".html")+"?"+_30():"javascript:false;")+"\" width=\"0\" height=\"0\"></iframe>";_26=document.getElementById("swfaddress");setTimeout(function(){if(!_2f["html"]&&typeof _26.contentWindow.swfaddress==_u){_4c();}com.asual.util.Events.addListener(_26,"load",_4e);},10);}else{if(_1e.isSafari()){if(_1e.getVersion()<412){document.body.innerHTML+="<form "+_51+" method=\"get\"></form>";_27=document.getElementById("swfaddress");}if(typeof _l.swfaddress==_u){_l.swfaddress={};}if(typeof _l.swfaddress[_l.pathname]!=_u){_2d=_l.swfaddress[_l.pathname].split(",");}}else{if(_1e.isOpera()&&_2e.length==0&&typeof navigator.plugins["Shockwave Flash"]=="object"){document.body.innerHTML+="<embed "+_51+" src=\""+_28.replace(/\.js(\?.*)?$/,".swf")+"\" type=\"application/x-shockwave-flash\" />";}}}setTimeout(_42,1);setTimeout(_43,2);setTimeout(_48,10);setInterval(_3e,50);};this.onInit=null;this.onChange=null;this.toString=function(){return "[class SWFAddress]";};this.back=function(){_h.back();};this.forward=function(){_h.forward();};this.go=function(_52){_h.go(_52);};this.href=function(url,_54){_54=typeof _54!=_u?_54:"_self";switch(_54){case "_self":self.location.href=url;break;case "_top":_l.href=url;break;case "_blank":window.open(url);break;default:top.frames[_54].location.href=url;break;}};this.popup=function(url,_56,_57,_58){var _59=window.open(url,_56,eval(_57));eval(_58);};this.addEventListener=function(_5a,_5b){if(typeof _2c[_5a]==_u){_2c[_5a]=[];}_2c[_5a].push(_5b);};this.removeEventListener=function(_5c,_5d){if(typeof _2c[_5c]!=_u){for(var i=0,l;l=_2c[_5c][i];i++){if(l==_5d){break;}}_2c[_5c].splice(i,1);}};this.dispatchEvent=function(_60){if(typeof _2c[_60.type]!=_u&&_2c[_60.type].length){_60.target=this;for(var i=0,l;l=_2c[_60.type][i];i++){l(_60);}return true;}return false;};this.hasEventListener=function(_63){return (typeof _2c[_63]!=_u&&_2c[_63].length>0);};this.getBaseURL=function(){var url=_l.href;if(url.indexOf("#")!=-1){url=url.substr(0,url.indexOf("#"));}if(url.substr(url.length-1)=="/"){url=url.substr(0,url.length-1);}return url;};this.getStrict=function(){return _2f["strict"];};this.setStrict=function(_65){_2f["strict"]=_65;};this.getHistory=function(){return _2f["history"];};this.setHistory=function(_66){_2f["history"]=_66;};this.getTracker=function(){return _2f["tracker"];};this.setTracker=function(_67){_2f["tracker"]=_67;};this.getIds=function(){return _2e;};this.getId=function(_68){return _2e[0];};this.setId=function(id){_2e[0]=id;};this.addId=function(id){this.removeId(id);_2e.push(id);};this.removeId=function(id){for(var i=0,_6d;_6d=_2e[i];i++){if(id==_6d){_2e.splice(i,1);break;}}};this.getTitle=function(){return _d.title;};this.setTitle=function(_6e){if(!_20){return null;}if(typeof _6e==_u){return;}if(_6e=="null"){_6e="";}_29=_d.title=_6e;if(_26&&_26.contentWindow){_26.contentWindow.document.title=_6e;}};this.getStatus=function(){return top.status;};this.setStatus=function(_6f){if(!_20){return null;}if(typeof _6f==_u){return;}if(!_1e.isSafari()){if(_6f=="null"){_6f="";}_6f=_33(_6f,true);if(_6f=="/"){_6f="";}if(!(/http(s)?:\/\//.test(_6f))){var _70=_l.href.indexOf("#");_6f=(_70==-1?_l.href:_l.href.substr(0,_70))+"#"+_6f;}top.status=_6f;}};this.resetStatus=function(){top.status="";};this.getValue=function(){if(!_20){return null;}return _33(_32,false);};this.setValue=function(_71){if(!_20){return null;}if(typeof _71==_u){return;}if(_71=="null"){_71="";}_71=_33(_71,true);if(_71=="/"){_71="";}if(_32==_71){return;}_32=_71;_2b=true;_3f();_2d[_h.length]=_32;if(_1e.isSafari()){if(_2f["history"]){_l.swfaddress[_l.pathname]=_2d.toString();_2a=_h.length+1;if(_1e.getVersion()<412){if(_l.search==""){_27.action="#"+_32;_27.submit();}}else{if(_1e.getVersion()<523){var evt=document.createEvent("MouseEvents");evt.initEvent("click",true,true);var _73=document.createElement("a");_73.href="#"+_32;_73.dispatchEvent(evt);}else{_l.hash="#"+_32;}}}else{_l.replace("#"+_32);}}else{if(_32!=_30()){if(_2f["history"]){_l.hash="#"+_36(_32);}else{_l.replace("#"+_32);}}}if(_1e.isIE()&&_2f["history"]){if(_2f["html"]){_26.contentWindow.location.assign(_26.contentWindow.location.pathname+"?"+_30());}else{_4c();}}_2b=false;};this.getPath=function(){var _74=this.getValue();if(_74.indexOf("?")!=-1){return _74.split("?")[0];}else{return _74;}};this.getPathNames=function(){var _75=SWFAddress.getPath();var _76=_75.split("/");if(_75.substr(0,1)=="/"){_76.splice(0,1);}if(_75.substr(_75.length-1,1)=="/"){_76.splice(_76.length-1,1);}return _76;};this.getQueryString=function(){var _77=this.getValue();var _78=_77.indexOf("?");if(_78!=-1&&_78<_77.length){return _77.substr(_78+1);}return "";};this.getParameter=function(_79){var _7a=this.getValue();var _7b=_7a.indexOf("?");if(_7b!=-1){_7a=_7a.substr(_7b+1);var _7c=_7a.split("&");var p,i=_7c.length;while(i--){p=_7c[i].split("=");if(p[0]==_79){return p[1];}}}return "";};this.getParameterNames=function(){var _7f=this.getValue();var _80=_7f.indexOf("?");var _81=[];if(_80!=-1){_7f=_7f.substr(_80+1);if(_7f!=""&&_7f.indexOf("=")!=-1){var _82=_7f.split("&");var i=0;while(i<_82.length){_81.push(_82[i].split("=")[0]);i++;}}}return _81;};if(!_20){_48();return;}for(var i=1;i<_2a;i++){_2d.push("");}_2d.push(_l.hash.replace(/^#/g,""));if(_1e.isIE()&&_l.hash!=_30()){_l.hash="#"+_36(_30());}try{_28=String(_38(document).src);var qi=_28.indexOf("?");if(_28&&qi>-1){var _86,_87=_28.substr(qi+1).split("&");for(var j=0,p;p=_87[j];j++){_86=p.split("=");if(/^(history|html|strict)$/.test(_86[0])){_2f[_86[0]]=(isNaN(_86[1])?eval(_86[1]):(parseFloat(_86[1])>0));}if(/^tracker$/.test(_86[0])){_2f[_86[0]]=_86[1];}}}}catch(e){}if(/file:\/\//.test(_l.href)){_2f["html"]=false;}_3d();com.asual.util.Events.addListener(document,"DOMContentLoaded",_50);};if(typeof swfobject!="undefined"){SWFObject=swfobject;}if(typeof FlashObject!="undefined"){SWFObject=FlashObject;}if(typeof SWFObject!="undefined"){if(SWFObject.prototype&&SWFObject.prototype.write){com.asual.SWFObjectWrite=SWFObject.prototype.write;SWFObject.prototype.write=function(){if(this.getAttribute("version").major<8){this.addVariable("$swfaddress",SWFAddress.getValue());((typeof arguments[0]=="string")?document.getElementById(arguments[0]):arguments[0]).so=this;}if(success=com.asual.SWFObjectWrite.apply(this,arguments)){SWFAddress.addId(this.getAttribute("id"));}return success;};}else{com.asual.SWFObjectRegisterObject=SWFObject.registerObject;SWFObject.registerObject=function(){com.asual.SWFObjectRegisterObject.apply(this,arguments);SWFAddress.addId(arguments[0]);};com.asual.SWFObjectCreateSWF=SWFObject.createSWF;SWFObject.createSWF=function(){com.asual.SWFObjectCreateSWF.apply(this,arguments);SWFAddress.addId(arguments[0].id);};com.asual.SWFObjectEmbedSWF=SWFObject.embedSWF;SWFObject.embedSWF=function(){com.asual.SWFObjectEmbedSWF.apply(this,arguments);SWFAddress.addId(arguments[8].id);};}}if(typeof UFO!="undefined"){com.asual.UFOCreate=UFO.create;UFO.create=function(){com.asual.UFOCreate.apply(this,arguments);SWFAddress.addId(arguments[0].id);};}if(typeof AC_FL_RunContent!="undefined"){com.asual.AC_FL_RunContent=AC_FL_RunContent;AC_FL_RunContent=function(){com.asual.AC_FL_RunContent.apply(this,arguments);for(var i=0,a;a=arguments[i];i++){if(a=="id"){SWFAddress.addId(arguments[i+1]);break;}}};}